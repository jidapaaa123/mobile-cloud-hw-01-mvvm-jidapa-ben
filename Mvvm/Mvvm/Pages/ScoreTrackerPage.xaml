<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Mvvm.Pages.ScoreTrackerPage"
             Title="ScoreTrackerPage">
    <Grid Padding="20" RowSpacing="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Round Counter at top -->
        <HorizontalStackLayout Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" 
                              Spacing="10" HorizontalOptions="Start">
            <Label Text="Round #" FontSize="20" FontAttributes="Bold" VerticalOptions="Center" />
            <Label Text="{Binding CurrentRound}" FontSize="20" FontAttributes="Bold" VerticalOptions="Center" />
        </HorizontalStackLayout>

        <!-- Left side: Player scores list -->
        <Border Grid.Row="1" Grid.Column="0" 
                StrokeThickness="1" 
                Stroke="#DDD" 
                Padding="10"
                Background="White">
            <VerticalStackLayout Spacing="10">
                <Label Text="Scores" FontSize="18" FontAttributes="Bold" HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding Players}" SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <VerticalStackLayout Padding="5">
                                <Label>
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="{Binding Name}" FontAttributes="Bold" />
                                            <Span Text=": " />
                                            <Span Text="{Binding Score}" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </VerticalStackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <!-- Center: Current player and other players with checkboxes -->
        <Border Grid.Row="1" Grid.Column="1" 
                StrokeThickness="1" 
                Stroke="#DDD" 
                Padding="20"
                Background="White"
                Margin="10,0,0,0">
            <VerticalStackLayout Spacing="20">
                <!-- Current Player Display -->
                <VerticalStackLayout Spacing="10" HorizontalOptions="Center">
                    <Label Text="Current Player" FontSize="16" HorizontalOptions="Center" TextColor="Gray" />
                    <Label Text="{Binding CurrentPlayer.Name}" 
                           FontSize="24" 
                           FontAttributes="Bold" 
                           HorizontalOptions="Center" />
                </VerticalStackLayout>

                <BoxView HeightRequest="2" Color="#DDD" Margin="0,10" />

                <!-- Other players with checkboxes -->
                <Label Text="Select Players Who Guessed Correctly:" FontSize="16" FontAttributes="Bold" />
                <CollectionView ItemsSource="{Binding OtherPlayers}" SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <HorizontalStackLayout Spacing="10" Padding="5">
                                <CheckBox IsChecked="{Binding IsCorrectGuess}" VerticalOptions="Center" />
                                <Label Text="{Binding Name}" FontSize="18" VerticalOptions="Center" />
                            </HorizontalStackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <!-- Bottom: Next Round and End Game buttons -->
        <HorizontalStackLayout Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                              Spacing="20" HorizontalOptions="Center">
            <Button Text="Next Round" 
                    Command="{Binding NextRoundCommand}"
                    WidthRequest="200" />
            <Button Text="End Game" 
                    Command="{Binding EndGameCommand}"
                    WidthRequest="200" />
        </HorizontalStackLayout>
    </Grid>
</ContentPage>