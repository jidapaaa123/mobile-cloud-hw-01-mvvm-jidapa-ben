<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Mvvm.Pages.ScoreTrackerPage"
             Title="ScoreTrackerPage"
             BackgroundColor="Black">
    <Grid Padding="15" RowSpacing="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Round Counter at top -->
        <HorizontalStackLayout Grid.Row="0" 
                              Spacing="10" 
                              HorizontalOptions="Center">
            <Label Text="Round #" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   TextColor="#00FF00" 
                   VerticalOptions="Center" />
            <Label Text="{Binding CurrentRound}" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   TextColor="White" 
                   VerticalOptions="Center" />
        </HorizontalStackLayout>

        <!-- Current Player Display -->
        <Border Grid.Row="1"
                StrokeThickness="2" 
                Stroke="#00FF00" 
                Padding="15"
                Background="#1a1a1a">
            <VerticalStackLayout Spacing="5" HorizontalOptions="Center">
                <Label Text="Current Player" 
                       FontSize="16" 
                       HorizontalOptions="Center" 
                       TextColor="#00FF00" />
                <Label Text="{Binding CurrentPlayer.Name}" 
                       FontSize="28" 
                       FontAttributes="Bold" 
                       TextColor="White" 
                       HorizontalOptions="Center" />
            </VerticalStackLayout>
        </Border>

        <!-- Main Content: Scores and Checkboxes side by side -->
        <Grid Grid.Row="2" ColumnSpacing="10" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Left side: Player scores list -->
            <Border Grid.Column="0"
                    StrokeThickness="2" 
                    Stroke="#00FF00" 
                    Padding="10"
                    Background="#1a1a1a">
                <ScrollView>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Scores" 
                               FontSize="20" 
                               FontAttributes="Bold" 
                               TextColor="#00FF00" 
                               HorizontalOptions="Center"
                               Margin="0,0,0,10" />
                        <CollectionView ItemsSource="{Binding Players}" SelectionMode="None">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5" ColumnSpacing="15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Name Label with highlight -->
                                        <Label Grid.Column="0" 
                                               Text="{Binding Name}" 
                                               FontAttributes="Bold"
                                               FontSize="16"
                                               HorizontalOptions="Start"
                                               LineBreakMode="TailTruncation">
                                            <Label.Triggers>
                                                <DataTrigger TargetType="Label" Binding="{Binding IsHighestScore}" Value="True">
                                                    <Setter Property="TextColor" Value="#00BBFF" />
                                                    <Setter Property="FontSize" Value="18" />
                                                </DataTrigger>
                                                <DataTrigger TargetType="Label" Binding="{Binding IsHighestScore}" Value="False">
                                                    <Setter Property="TextColor" Value="White" />
                                                </DataTrigger>
                                            </Label.Triggers>
                                        </Label>
                                        
                                        <!-- Score Label with highlight -->
                                        <Label Grid.Column="1" 
                                               Text="{Binding Score}" 
                                               FontSize="16"
                                               HorizontalOptions="Start"
                                               Margin="0,0,10,0">
                                            <Label.Triggers>
                                                <DataTrigger TargetType="Label" Binding="{Binding IsHighestScore}" Value="True">
                                                    <Setter Property="TextColor" Value="#00BBFF" />
                                                    <Setter Property="FontSize" Value="18" />
                                                    <Setter Property="FontAttributes" Value="Bold" />
                                                </DataTrigger>
                                                <DataTrigger TargetType="Label" Binding="{Binding IsHighestScore}" Value="False">
                                                    <Setter Property="TextColor" Value="White" />
                                                </DataTrigger>
                                            </Label.Triggers>
                                        </Label>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </ScrollView>
            </Border>

            <!-- Right side: Other players with checkboxes -->
            <Border Grid.Column="1"
                    StrokeThickness="2" 
                    Stroke="#00FF00" 
                    Padding="10"
                    Background="#1a1a1a">
                <ScrollView>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Guessed Correctly" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               TextColor="#00FF00"
                               HorizontalOptions="Center"
                               Margin="0,0,0,10" />
                        <CollectionView ItemsSource="{Binding OtherPlayers}" SelectionMode="None">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5" ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <CheckBox Grid.Column="0"
                                                  IsChecked="{Binding IsCorrectGuess}" 
                                                  Color="#00FF00" 
                                                  VerticalOptions="Center" />
                                        <Label Grid.Column="1"
                                               Text="{Binding Name}" 
                                               FontSize="16" 
                                               TextColor="White" 
                                               VerticalOptions="Center"
                                               LineBreakMode="TailTruncation" />
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </ScrollView>
            </Border>
        </Grid>

        <!-- Bottom: Buttons -->
        <Grid Grid.Row="3" ColumnSpacing="10" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0"
                    Text="Next Round" 
                    Command="{Binding NextRoundCommand}"
                    BackgroundColor="#00FF00"
                    TextColor="Black"
                    FontSize="16"
                    FontAttributes="Bold"
                    HeightRequest="50" />
            
            <Button Grid.Column="1"
                    Text="End Game" 
                    Command="{Binding EndGameCommand}"
                    BackgroundColor="#00FF00"
                    TextColor="Black"
                    FontSize="16"
                    FontAttributes="Bold"
                    HeightRequest="50" />
        </Grid>
    </Grid>
</ContentPage>